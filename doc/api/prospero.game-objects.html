<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>prospero.game-objects documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Prospero</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to Prospero</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>prospero</span></div></div></li><li class="depth-2 branch"><a href="prospero.animation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>animation</span></div></a></li><li class="depth-2 branch"><a href="prospero.audio.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>audio</span></div></a></li><li class="depth-2 branch"><a href="prospero.collisions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>collisions</span></div></a></li><li class="depth-2 branch"><a href="prospero.compatibility.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compatibility</span></div></a></li><li class="depth-2 branch"><a href="prospero.constraints.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>constraints</span></div></a></li><li class="depth-2 branch"><a href="prospero.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="prospero.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch current"><a href="prospero.game-objects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>game-objects</span></div></a></li><li class="depth-2 branch"><a href="prospero.loop.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>loop</span></div></a></li><li class="depth-2 branch"><a href="prospero.math.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-2 branch"><a href="prospero.mutable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mutable</span></div></a></li><li class="depth-2 branch"><a href="prospero.pluggable-game-system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pluggable-game-system</span></div></a></li><li class="depth-2"><a href="prospero.updaters.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>updaters</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="prospero.game-objects.html#var-add-animator"><div class="inner"><span>add-animator</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-add-animators"><div class="inner"><span>add-animators</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-add-constraints"><div class="inner"><span>add-constraints</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-add-update-state"><div class="inner"><span>add-update-state</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-base-object"><div class="inner"><span>base-object</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-border-radius"><div class="inner"><span>border-radius</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-bounds-box"><div class="inner"><span>bounds-box</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-children"><div class="inner"><span>children</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-colour-rgb"><div class="inner"><span>colour-rgb</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-colour-rgba"><div class="inner"><span>colour-rgba</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-debug"><div class="inner"><span>debug</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-position-2d"><div class="inner"><span>position-2d</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-position-3d"><div class="inner"><span>position-3d</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-process-event"><div class="inner"><span>process-event</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-render-status"><div class="inner"><span>render-status</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-rotation-2d"><div class="inner"><span>rotation-2d</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-sprite-index"><div class="inner"><span>sprite-index</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-sprite-sheet"><div class="inner"><span>sprite-sheet</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-text"><div class="inner"><span>text</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-text-padding"><div class="inner"><span>text-padding</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-text-rgb"><div class="inner"><span>text-rgb</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-texture"><div class="inner"><span>texture</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-update-state"><div class="inner"><span>update-state</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-watch-collision"><div class="inner"><span>watch-collision</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-watch-mutable"><div class="inner"><span>watch-mutable</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-watch-root"><div class="inner"><span>watch-root</span></div></a></li><li class="depth-1"><a href="prospero.game-objects.html#var-wireframe"><div class="inner"><span>wireframe</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">prospero.game-objects</h1><div class="doc"><div class="markdown"><p>This has collected convenience functions for building up game objects.</p></div></div><div class="public anchor" id="var-add-animator"><h3>add-animator</h3><div class="usage"><code>(add-animator object [data-path change-description curve extra-args])</code></div><div class="doc"><div class="markdown"><p>Add an animation to the object, specified by an animation description. See <code>prospero.animation</code> for more details.</p></div></div></div><div class="public anchor" id="var-add-animators"><h3>add-animators</h3><div class="usage"><code>(add-animators object animators)</code></div><div class="doc"><div class="markdown"><p>Add multiple animators to the object, specified by a vector of animation descriptions. See <code>prospero.animation</code> for more details.</p></div></div></div><div class="public anchor" id="var-add-constraints"><h3>add-constraints</h3><div class="usage"><code>(add-constraints object constraints)</code></div><div class="doc"><div class="markdown"><p>Add a constraint from the constraints namespace to the object. The use of canned constraints makes it easier to build an entirely declarative definition of the game state.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/add-constraints [::proconstraint/keep-on-screen]))
</code></pre></div></div></div><div class="public anchor" id="var-add-update-state"><h3>add-update-state</h3><div class="usage"><code>(add-update-state object updater-fn)</code></div><div class="doc"><div class="markdown"><p>Compose an update-state function with the current chain of state updating functions. This allows the build up of per-frame behaviours to game-objects in a composable way.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/update-state
      (fn [me _ _ root-state]
        ...
        me)) ; - make some modifications or send some signals
    (progo/add-update-state
      (fn [me _ _ _]
        ...
        me))) ; - add another fn around the first
</code></pre>
<p>This is a good way to share composable state functions.</p></div></div></div><div class="public anchor" id="var-base-object"><h3>base-object</h3><div class="usage"><code>(base-object game-system)</code></div><div class="doc"><div class="markdown"><p>Create the base map for a game-object. Most game-objects will be built with this pattern:</p>
<pre><code>(-&gt; (progo/base-object game-system)
    ...)
</code></pre></div></div></div><div class="public anchor" id="var-border-radius"><h3>border-radius</h3><div class="usage"><code>(border-radius object r)</code></div><div class="doc"><div class="markdown"><p>Round the corners of a square box. If the object is a box, round off the corners. Likely most useful in <em>Iris</em>.</p>
<pre><code>(-&gt; (progo/base-object   game-system)
    (progo/bounds-box    25 25)
    (progo/colour-rgb    0 0 255)
    (progo/border-radius 3
    (progo/wireframe)) ; - make an empty blue box 25x25 with rounded corners
</code></pre></div></div></div><div class="public anchor" id="var-bounds-box"><h3>bounds-box</h3><div class="usage"><code>(bounds-box object width height)</code></div><div class="doc"><div class="markdown"><p>Set the <code>width</code> and <code>height</code> on an object. <em>Iris</em> uses this as the object’s  physical bounds, so these values are meaningful for 2d games. Collisions  are governed by the bounds-box specified in <code>watch-collisions</code>, so an object’s hitbox can be different from its visual extent.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/bounds-box  64 64)) ; - create a 64x64 square game-object
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to introduce the concept of units to most display measurements. </p></div></div></div><div class="public anchor" id="var-children"><h3>children</h3><div class="usage"><code>(children object &amp; kids)</code></div><div class="doc"><div class="markdown"><p>Attach any number of child objects to the game-state.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/children
      (-&gt; (progo/base-object game-system) ...)
      (-&gt; (progo/base-object game-system) ...)
      ...))
</code></pre></div></div></div><div class="public anchor" id="var-colour-rgb"><h3>colour-rgb</h3><div class="usage"><code>(colour-rgb object r g b)</code></div><div class="doc"><div class="markdown"><p>Request that the object have a supplied colour</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/colour-rgb  0 255 0)) ; - make a pure green object
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to support more colour models this routine will likely remain safe to use, though. </p></div></div></div><div class="public anchor" id="var-colour-rgba"><h3>colour-rgba</h3><div class="usage"><code>(colour-rgba object r g b a)</code></div><div class="doc"><div class="markdown"><p>Request that the object have a supplied colour</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/colour-rgba 0 255 0 0.5)) ; - make a pure green object at 50% alpha
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to support more colour models this routine will likely remain safe to use, though. </p></div></div></div><div class="public anchor" id="var-debug"><h3>debug</h3><div class="usage"><code>(debug object)</code></div><div class="doc"><div class="markdown"><p>Instruct this object to dump some of its details to whatever debug features  are supported by the targeted plug-able game system. Currently this is a no-op, but is likely to see implementation in the 1.0.0 time-frame.</p></div></div></div><div class="public anchor" id="var-position-2d"><h3>position-2d</h3><div class="usage"><code>(position-2d object x y)</code></div><div class="doc"><div class="markdown"><p>Sets the 2d position for a game-object.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/position-2d 50 50)) ; - position an object at 50, 50 pixels
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to introduce the concept of units to most display measurements. </p></div></div></div><div class="public anchor" id="var-position-3d"><h3>position-3d</h3><div class="usage"><code>(position-3d object x y z)</code></div><div class="doc"><div class="markdown"><p>Set the position for an object.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/position-3d 50 50 10)) ; - position an object at 50, 50, 10 pixels
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to introduce the concept of units to most display measurements. </p></div></div></div><div class="public anchor" id="var-process-event"><h3>process-event</h3><div class="usage"><code>(process-event object event-map)</code></div><div class="doc"><div class="markdown"><p>Provide a map of event descriptors to functions or prebuilt routines that can modify this object. Descriptors are vectors containing the event type and  the subtype/signal. For example: <code>[:prospero.events/keyboard-up :prospero.events/key-letter-a]</code> The event codes will be mapped to a function taking the object/node itself, the arguments for the event, and the root-state. Event arguments are a vector: <code>[major-event-code minor-event-code {:signal-args details}]</code>.</p>
<pre><code>(-&gt; (progo/base-object game-system)
     (progo/process-event
                      {[::proevent/keyboard-held ::proevent/key-arrow-up]
                       [proevent/change-animators-on-event {:animate-up :running}]

                       [::proevent/keyboard-up   ::proevent/key-arrow-up]
                       [proevent/change-animators-on-event {:animate-up :stopped}]

                       [::proevent/keyboard-up   ::proevent/key-space-bar]
                       (fn [me [_ _ {:keys [signal-args]}] root-state]
                          ...)}))
</code></pre></div></div></div><div class="public anchor" id="var-render-status"><h3>render-status</h3><div class="usage"><code>(render-status object status)</code></div><div class="doc"><div class="markdown"><p>Setting render-status to <code>:hidden</code> will hide it from display.  Other <code>status</code> values will currently display the object.  Available status values and behaviours may change with the targeted  plug-able game system.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/render-status :hidden)) ; - hides the object from the display
</code></pre></div></div></div><div class="public anchor" id="var-rotation-2d"><h3>rotation-2d</h3><div class="usage"><code>(rotation-2d object theta)</code></div><div class="doc"><div class="markdown"><p>Set the rotation for an object in a 2d game - most meaningful for <em>Iris</em>.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/position-3d 50 50 10) ; - position an object at 50, 50, 10 pixels
    (progo/rotation-2d 45))      ; - and rotate 45 degrees clockwise
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to introduce the concept of units (both position and rotation) to most display measurements. </p></div></div></div><div class="public anchor" id="var-sprite-index"><h3>sprite-index</h3><div class="usage"><code>(sprite-index object col row)</code></div><div class="doc"><div class="markdown"><p>Provide a column and row index into a sprite-sheet</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/sprite-sheet {:sprite-sheet-path "/my/image.png"
                         :sprite-width      64
                         :sprite-height     64
                         :columns           10
                         :rows              10}) ; - set up the image
    (progo/sprite-index 2 2)) ; - use image at column and row 2
</code></pre></div></div></div><div class="public anchor" id="var-sprite-sheet"><h3>sprite-sheet</h3><div class="usage"><code>(sprite-sheet object {:keys [sprite-sheet-path sprite-width sprite-height columns rows], :as sprite-sheet})</code></div><div class="doc"><div class="markdown"><p>Make a sprite sheet available to an object. A sprite sheet  describes where a texture comes from and works in conjunction with  <code>sprite-index</code>. A sprite sheet contains a map, as such:</p>
<pre><code>{:sprite-sheet-path   "/path/to/image"
   :sprite-width      a natural number specifying the width of a tile
   :sprite-height     a natural number specifying the height of a tile
   :columns           how many tile columns are in the sprite sheet
   :rows              how many rows}
</code></pre></div></div></div><div class="public anchor" id="var-text"><h3>text</h3><div class="usage"><code>(text object text)</code></div><div class="doc"><div class="markdown"><p>Make this node a text node</p>
<pre><code>(-&gt; (progo/base-object game-system)
     (progo/text "some text to display"))
</code></pre>
<p>Text is likely to be incompatible with textures, sprite sheets, etc. </p></div></div></div><div class="public anchor" id="var-text-padding"><h3>text-padding</h3><div class="usage"><code>(text-padding object left top right bottom)</code></div><div class="doc"><div class="markdown"><p>Provide some space around a text game-object</p>
<pre><code> (-&gt; (progo/base-object game-system)
     (progo/text-padding 10 20 10 20)) ; - build in some white-space around the text
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to introduce the concept of units to most display measurements. </p></div></div></div><div class="public anchor" id="var-text-rgb"><h3>text-rgb</h3><div class="usage"><code>(text-rgb object r g b)</code></div><div class="doc"><div class="markdown"><p>Request that the object have a supplied colour for its text</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/colour-rgb  255 255 255)
    (progo/text-rgb    0     0   0)) ; - black text on white
</code></pre>
<p>NB: future versions of <em>Prospero</em> are likely to support more colour models this routine will likely remain safe to use, though. </p></div></div></div><div class="public anchor" id="var-texture"><h3>texture</h3><div class="usage"><code>(texture object texture-file)</code></div><div class="doc"><div class="markdown"><p>Use a image file as a bitmap texture for the object.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/texture     "/path"to"image.png"))
</code></pre></div></div></div><div class="public anchor" id="var-update-state"><h3>update-state</h3><div class="usage"><code>(update-state object updater-fn)</code></div><div class="doc"><div class="markdown"><p>Provide a function that is called at each from to modify the state  of this object. The function should be in this form:</p>
<pre><code>(fn [me-the-object current-time-code frame-elapsed-time root-state])
</code></pre>
<p>A game-object map must be returned</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/update-state
      (fn [me _ _ root-state]
        ...
        me))) ; - make some modifications or send some signals
</code></pre></div></div></div><div class="public anchor" id="var-watch-collision"><h3>watch-collision</h3><div class="usage"><code>(watch-collision object {:keys [bounds-box level-set match-set on-hit-fn reset-fn offset], :as cd-struct, :or {offset [0 0 0]}})</code></div><div class="doc"><div class="markdown"><p>Call this to add a set of collision detection bounds and  details to an object. Anything with collision details  will be tested and a collision will be called before the  object’s state is updated. A collision map has the following form:</p>
<pre><code>{:bounds-box  [w h]   ; -can be different from normal bounds
  :offset     [x y z] ; - offset from "left" where the bounds start
  :level-set  #{} ; - a set of collision levels this belongs on
  :match-set  #{} ; - a set of collision levels this matches with
  :on-hit-fn  (fn [me collider root-state]) ; - a fn called during collision - updates me
  :reset-fn   (fn [me])} ; - called if me is no longer colliding
</code></pre></div></div></div><div class="public anchor" id="var-watch-mutable"><h3>watch-mutable</h3><div class="usage"><code>(watch-mutable object)</code></div><div class="doc"><div class="markdown"><p>Instruct the object to observe the game’s mutable state at each frame. If this is turned on, <em>Prospero</em> will provide a snapshot of the mutable state atom with each loop. This was the first adhoc inter-object communication system added to the engine. It’s probably better to prefer <code>watch-root</code> and signals over this. The mutable state can be queried in <code>:watch-mutable-state</code> during event processing (<code>update-state</code>), collisions, and any other fn that takes the is passed the object as an argument.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/watch-mutable)  ; - flag interest in the mutable state
    (progo/update-state    ; - write an updater that uses it
      (fn [me _ _ _] (get-in me [:watch-mutable-state]))))
</code></pre>
<p>NB: This seems easy to use, but it may be retired in future versions. signals and watch-root seem a mostly better option.</p></div></div></div><div class="public anchor" id="var-watch-root"><h3>watch-root</h3><div class="usage"><code>(watch-root object)</code></div><div class="doc"><div class="markdown"><p>Instruct the object to observe the game’s evolving state at each frame of the game loop. If this is turned on, Prospero will provide a snapshot of the top of the game-object graph allowing the local node to observe the state of other objects in the graph by using get-in or similar.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/watch-root)     ; - flag interest in the root state
    (progo/update-state    ; - write an updater that uses it
      (fn [me _ _ root-state] ...)))
</code></pre>
<p>NB: This marker must be provided for an <code>update-state</code> fn to receive the root-state. This restriction may be lifted in future versions, but it’s probably a good practice to mark which objects look back “up” the graph. </p></div></div></div><div class="public anchor" id="var-wireframe"><h3>wireframe</h3><div class="usage"><code>(wireframe object)</code></div><div class="doc"><div class="markdown"><p>Do not use a fill colour, paint edges only.</p>
<pre><code>(-&gt; (progo/base-object game-system)
    (progo/bounds-box  25 25)
    (progo/colour-rgb  0 0 255)
    (progo/wireframe)) ; - make an empty blue box 25x25
</code></pre></div></div></div></div></body></html>